<htmlform formUuid="889ce948-f1ee-4656-91af-147a9e760309" formName="Laboratory Order and Result form" formEncounterType="7ccf3847-7bc3-42e5-8b7e-4125712660ea" formVersion="1.0">
    <style>
.section {
border: 1px solid $headerColor;
padding: 2px;
text-align: left;
margin-bottom: 1em;
}

.sectionHeader {
background-color: #2f1c55;
color: white;
/* display: block; */
padding: 2px;
font-weight: bold;
}

table tr:nth-child(even) {
background: #ffffff;
}

.alnleft_s {
text-align: left;
color: #000000;
width: 13%;
}

.alnright_s {
text-align: right;
color: #000000;
width: 13%;
}

.alnright {
text-align: right;
color: #000000;
width: 25%;
}

.alnright_i {
text-align: right;
color: #000000;
width: 40%;
}

.alnleft {
text-align: left;
color: #000000;
width: 25%;
}

.error {
color: red;
}

td {
border: none;
}

table th,
table td {
padding: 5px 10px;
border: None;
}

.legend_style {
max-width: 35%;
background: #FAFAFA;
<!--padding: 5px;
-->margin: 0px left;
box-shadow: 1px 1px 25px rgba(0, 0, 0, 0.10);
border-radius: 2px;
border: 1px solid #305a72;
border-bottom-left-radius: 2px;
text-transform: initial;
}

form fieldset,
.form fieldset {
min-width: 98%;
border: none;
border-top: 1px solid #305a72;
}

table th,
table td {
padding: 5px 10px;
/* border: 1px solid #DDD; */
}

table tr {
border: None;
}

ul.select,
.form input,
.form select,
.form textarea,
.form ul.select {
padding: 2px 10px;
}

form input,
form select,
form textarea,
form ul.select,
.form input,
.form select,
.form textarea,
.form ul.select {
padding: 2px 10px;
}

form select,
.form select {
max-width: 200px;
}

body {
font-family: "OpenSans", Arial, sans-serif;
color: #363463;
font-size: 14px;
}
</style>
    <script type="text/javascript">
var $ = jQuery;
$(document).ready(function() {
$('.hasDatepicker').attr('readOnly', true)
});
</script>

    <table style="margin-bottom: 20px;">
        <thead>
        <tr>
            <th colspan='5' style="text-align: center">Laboratory Order &amp; Result Form</th>
        </tr>
        </thead>
    </table>

    <table class="table" width="100%">
        <tbody>
        <tr>
            <td class="alnright">Visit Date</td>
            <td class="alnleft">
                <encounterDate default="now" showTime="false" allowFutureDates="false" required="true" />
            </td>
            <td class="alnright"></td>
        </tr>
        </tbody>
    </table>

    <fieldset>
        <table>
            <tr>             
                <td class="alnleft">
                    Lab Registration Number
                </td>
                <td>
                    <obs conceptId="165394" />
                </td>
                
                <td class="alnleft">Indication for AHD</td>
                <td>
                    <obs conceptId="167079" answerConceptIds="162080,162081" answerLabels="Baseline,Repeat" />
                </td>
            </tr>
            <tr>
                <th class="alnleft"><label>Order</label></th>
                <th><label>Results</label></th>
                <th class="alnleft"><label>Order</label></th>
                <th><label>Results</label></th>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165731" style="checkbox" value="false" />CD4+ cell count (cells/mm3)</td>
                <td>
                    <obs conceptId="5497" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165748" style="checkbox" value="false" />CD4 (%)</td>
                <td>
                    <obs conceptId="730" />
                </td>
            </tr>
            <tr>
                <td>
                    <obs conceptId="167085" style="checkbox" value="false" labelText="CD4 LFA" toggle="CD4LFA" />
                </td>
                <td><obs conceptId="167088" answerConceptIds="167086,167087" answerLabels="&lt;200,&gt;=200" /></td>
                <td class="alnleft">
                    <obs conceptId="165732" style="checkbox" value="false" />WBC (x10<sup>9</sup> c/L)
                </td>
                <td>
                    <obs conceptId="678" />
                </td>
            </tr>
            <tr id="CD4LFA"> 
                <td>Time CD4 LFA sample collected</td>
                <td><obs conceptId="167091" /></td>
                <td>Time CD4 LFA result received</td>
                <td><obs conceptId="167092" /></td>
            </tr> 
            <tr>
                <td class="alnleft">
                    <obs conceptId="165749" style="checkbox" value="false" />Polymorphs (/mm<sup>3</sup>)</td>
                <td>
                    <obs conceptId="1022" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165918" style="checkbox" value="false" />Polymorphs (%)</td>
                <td>
                    <obs conceptId="165919" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165733" style="checkbox" value="false" />Lymphocytes (/mm<sup>3</sup>)</td>
                <td>
                    <obs conceptId="1319" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165750" style="checkbox" value="false" />Lymphocytes (%)</td>
                <td>
                    <obs conceptId="1338" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165734" style="checkbox" value="false" />Monocytes (/mm<sup>3</sup>)</td>
                <td>
                    <obs conceptId="1023" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165751" style="checkbox" value="false" />Monocytes (%)</td>
                <td>
                    <obs conceptId="1339" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165735" style="checkbox" value="false" />Eosinophils (/mm<sup>3</sup>)</td>
                <td>
                    <obs conceptId="1024" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165752" style="checkbox" value="false" />Eosinophil (%)</td>
                <td>
                    <obs conceptId="1340" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165736" style="checkbox" value="false" />Basophils (/mm<sup>3</sup>)</td>
                <td>
                    <obs conceptId="1025" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165753" style="checkbox" value="false" />Basophils (%)</td>
                <td>
                    <obs conceptId="1341" />
                </td>
            </tr>

            <tr>
                <td class="alnleft">
                    <obs conceptId="165737" style="checkbox" value="false" />PCV/Hb (%)</td>
                <td>
                    <obs conceptId="165395" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165921" style="checkbox" value="false" />PCV/Hb (g/dl)</td>
                <td>
                    <obs conceptId="165920" />
                </td>

            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165754" style="checkbox" value="false" />Platelets (x 10<sup>9</sup> c/L)</td>
                <td>
                    <obs conceptId="729" />
                </td>
                <td colspan="2"> </td>
            </tr>

            <tr>
                <td class="alnleft">
                    <obs conceptId="165738" style="checkbox" value="false" />HCV antibody </td>
                <td>
                    <obs conceptId="1325" answerConceptIds="703,664" answerLabels="Positive,Negative" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165755" style="checkbox" value="false" />HBsAG </td>
                <td>
                    <obs conceptId="159430" answerConceptIds="703,664" answerLabels="Positive,Negative" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165739" style="checkbox" value="false" />VDRL </td>
                <td>
                    <obs conceptId="299" answerConceptIds="1228,1229" answerLabels="Reactive,Non-Reactive" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165756" style="checkbox" value="false" />Creatinine (µmol/l)</td>
                <td>
                    <obs conceptId="164364" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165740" style="checkbox" value="false" />ALT/SGPT (U/I)</td>
                <td>
                    <obs conceptId="654" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165922" style="checkbox" value="false" />ALT/SGPT (mmol/L)</td>
                <td>
                    <obs conceptId="165923" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165757" style="checkbox" value="false" />AST/SGOT (µ/L)</td>
                <td>
                    <obs conceptId="653" />
                </td>
                <td colspan="2"> </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165741" style="checkbox" value="false" />Alk. Phosphate (U/l)</td>
                <td>
                    <obs conceptId="785" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165758" style="checkbox" value="false" />Total Bilirubin (µmol/l)</td>
                <td>
                    <obs conceptId="655" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165742" style="checkbox" value="false" />Na+ (mmol/L)</td>
                <td>
                    <obs conceptId="1132" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165759" style="checkbox" value="false" />K+ (mmol/L)</td>
                <td>
                    <obs conceptId="1133" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165743" style="checkbox" value="false" />Fasting Glucose (mmol/l)</td>
                <td>
                    <obs conceptId="160053" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165760" style="checkbox" value="false" />Total Cholesterol (mmol/l)</td>
                <td>
                    <obs conceptId="1006" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165744" style="checkbox" value="false" />LDL (mmol/L)</td>
                <td>
                    <obs conceptId="1008" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165761" style="checkbox" value="false" />HDL (mmol/L)</td>
                <td>
                    <obs conceptId="1007" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165745" style="checkbox" value="false" />Glucose</td>
                <td>
                    <obs conceptId="160053" />
                </td>

                <td class="alnleft">
                    <obs conceptId="165762" style="checkbox" value="false" />Protein</td>
                <td>
                    <obs conceptId="165926" />
                </td>
            </tr>
            <tr>
                <td class="alnleft">
                    <obs conceptId="165746" style="checkbox" value="false" />Cytology/Pap Smear: </td>
                <td>
                    <obs conceptId="165927" />
                </td>
                <td class="alnleft">
                    <obs conceptId="165763" style="checkbox" value="false" />Triglyceride</td>
                <td>
                    <obs conceptId="1009" />
                </td>
            </tr>

            <tr>
                <excludeIf velocityTest="$patient.gender == 'M' ">
                    <td class="alnleft">
                        <obs conceptId="165747" style="checkbox" value="false" />Pregnancy</td>
                    <td>
                        <obs conceptId="45" answerConceptIds="703,664" answerLabels="Positive,Negative" />
                    </td>

                </excludeIf>
                <td class="alnleft">
                    <obs conceptId="165764" style="checkbox" value="false" />Malaria smear</td>
                <td>
                    <obs conceptId="32" answerConceptIds="664,703" answerLabels="Positive,Negative" />
                </td>
            </tr>

            <tr>
                <td class="alnleft">
                    <obs conceptId="167080" style="checkbox" value="false" />TB LF LAM </td>
                <td>
                    <obs conceptId="166697" answerConceptIds="703,664" answerLabels="Positive,Negative" />
                </td>
                <td class="alnleft">
                    <obs conceptId="167095" style="checkbox" value="false" />Urinalysis</td>
                <td>
                    <obs conceptId="160987" />
                </td>
            </tr>
           
           
        </table>

        <fieldset id="additional" style="border: 1px solid #305a72; min-width: 98%; padding: 6px; margin-bottom: 2%; border-radius: 9px;">
            <table>
                <tr>
                    <td>
                        <obs conceptId="167089" style="checkbox" value="false" labelText="Serology for CrAg" toggle="SerologyforCrAg" />
                    </td>
                    <td><obs conceptId="167090" answerConceptIds="703,664" answerLabels="Positive,Negative" /></td>
                    <td class="alnleft">
                        <obs conceptId="167081" style="checkbox" value="false" />CSF for CrAg</td>
                    <td>
                        <obs conceptId="167082" answerConceptIds="703,664" answerLabels="Positive,Negative" />
                    </td>
                </tr>
                <tr id="SerologyforCrAg"> 
                        <td>Time Serology for CrAg sample collected</td>
                        <td><obs conceptId="167093" /></td>
                        <td>Time Serology for CrAg result received</td>
                        <td><obs conceptId="167094" /></td>
                </tr>  
               <!-- - <tr>
                    <td class="alnleft">
                        <obs conceptId="167083" style="checkbox" value="false" />CSF for M/C/S</td>
                    <td>
                        <obs conceptId="167084" />
                    </td>                   
                </tr> -->
            </table>           
        </fieldset>      
        <fieldset id="additional" style="border: 1px solid #305a72; min-width: 90%; padding: 6px; margin-bottom: 2%; border-radius: 9px;">
            <table>
                <tr>
                    <b>Additional tests</b> (only be performed by laboratory if exact clinical indication is specified and signed by clinician)              
                </tr>
            </table>
            <fieldset id="in"  style="min-width: 100%; padding: 0px; "></fieldset>
            <table>
                <tr>
                    <td class="alnleft"><b>Specify exact clinical indication for requested tests:</b></td>
                    <td><obs conceptId="165717" /></td>
                </tr>
            </table>
        </fieldset>
    </fieldset>

    <fieldset>
        <legend class="legend_style">Viral Load</legend>
        <table>
            <tr>
                <td class="alnright">
                    <obs conceptId="165765" style="checkbox" value="false" labelText="Viral Load Test" toggle="viralLoad" />
                </td>
            </tr>
        </table>

        <table id="viralLoad">
            <tr>
                <td class="alnleft_s">Sample ID.
                    <p>
                        <obs conceptId="165715" />
                    </p>
                </td>
                <td class="alnleft_s">Sample Type
                    <p>
                        <obs conceptId="162476" answerConceptIds="1000,1002,165568,166615" answerLabels="Whole Blood,Plasma,DBS,Plasma separation card(PSC)" />
                    </p>
                </td>
                <td class="alnleft_s">Indication for Viral Load
                    <p>
                        <obs id="viral_load" conceptId="164980" answerConceptIds="162080,161236,162082,162081,163523,160566, 165978" answerLabels="Baseline (6 months after ART initiation), Routine (every 12 months), Confirmation (3-6 months after intense adherence counselling), Repeat test, Clinical failure, Immunological failure, PMTCT 32-36 weeks gestation">
                            <controls>
                                <when value="162081" thenDisplay="#repeat_id" />
                            </controls>
                        </obs>
                    </p>
                </td>
            </tr>
            <tr>
                <td colspan="2" id="repeat_id">
                    <table>
                        <tr>
                            <td class="alnleft_s">Reason for Repeat
                                <p>
                                    <obs conceptId="165831" />
                                </p>
                            </td>
                        </tr>
                    </table>
                </td>
                <td class="alnleft_s">Sample collection date
                    <p>
                        <obs conceptId="159951" allowFutureDates="false" />
                    </p>
                </td>

                <td class="alnleft_s">Date sample sent to PCR Lab
                    <p>
                        <obs conceptId="165988" allowFutureDates="false" />
                    </p>
                </td>

                <td class="alnleft_s">Date sample received at PCR Lab
                    <p>
                        <obs conceptId="165716" allowFutureDates="false" />
                    </p>
                </td>
            </tr>

            <tr>


                <td class="alnleft_s">Date result was sent from PCR Lab
                    <p>
                        <obs conceptId="165989" allowFutureDates="false" />
                    </p>
                </td>

                <td class="alnleft_s">Date result was received at the facility
                    <p>
                        <obs conceptId="165987" allowFutureDates="false" />
                    </p>
                </td>

                <td class="alnleft_s">Result Date
                    <p>
                        <obs conceptId="166423" allowFutureDates="false" />
                    </p>
                </td>

            </tr>
            <tr>

                <td class="alnleft_s">Assay Date
                    <p>
                        <obs conceptId="166424" allowFutureDates="false" />
                    </p>
                </td>

                <td class="alnleft_s">Approval Date
                    <p>
                        <obs conceptId="166425" allowFutureDates="false" />
                    </p>
                </td>
                <!-- Id "viralLoadResultTest" Added by Ebuka" -->

                <td class="alnleft_s">Alphanumeric Viral Load Result
                    <p><obs id="AlphanumericViralLoadResult" conceptId="166422" answerConceptIds="166407, 166408, 166409, 166410,166411,166412,166413,166414,166415,166416,166417,166418,166419,163611, 166420, 166421, 166426" answerLabels="&lt;20 , &lt;29 , &lt;40 , &lt;400 , &lt;80 , &gt;10 000 000 ,  Aborted, Double entry, Duplicate , Failed , Failed twice , Incomplete number , Incorrect entry , Invalid , Target Not Detected , Wrong entry, Numeric Value  " /></p>

                </td>
                <!-- Added by Ebuka -->



            </tr>
            <tr id="NumericViralLoadResult">
                <td colspan="2"></td>
                <td class="alnleft_s">Viral Load test result
                    <p>
                        <obs conceptId="856" labelText="" id="viralLoadResultTest" />copies/ml
                    </p>
                </td>
            </tr>
        </table>
    </fieldset>

    <fieldset>
        <legend class="legend_style">Signatures</legend>
        <table>
            <tr>
                <td class="alnleft_s">Name of Clinician</td>
                <td>
                    <encounterProvider role="Provider" />
                </td>
                <td class="alnleft_s">Date Ordered</td>
                <td>
                    <obs conceptId="164989" required="true" allowFutureDates="false" />
                </td>

                <td class="alnleft_s"></td>
                <td class="alnleft_s"></td>
            </tr>
            <tr>
                <td class="alnleft_s">Reported By</td>
                <td>
                    <obs conceptId="164982" style="person" />
                </td>
                <td class="alnleft_s">Date Reported</td>
                <td>
                    <obs conceptId="165414" allowFutureDates="false" />
                </td>


                <td class="alnleft_s"></td>
                <td class="alnleft_s"></td>
            </tr>
            <tr>
                <td class="alnleft_s">Checked By</td>
                <td>
                    <obs conceptId="164983" labelText="" style="person" />
                </td>
                <td class="alnleft_s">Date checked</td>
                <td>
                    <obs conceptId="164984" allowFutureDates="false" />
                </td>

                <td class="alnleft_s"></td>
                <td class="alnleft_s"></td>
            </tr>
            <tr>
                <td class="alnleft_s">Facility</td>
                <td>
                    <encounterLocation default="SessionAttribute:emrContext.sessionLocationId" />
                </td>
            </tr>
        </table>
    </fieldset>
    <submit/>

    <script type="text/javascript">

jQuery(function() {
getField('viralLoadResultTest.value').change(function() {
var viralLoadInput = getValue('viralLoadResultTest.value');
if (viralLoadInput == "TND" || viralLoadInput == "tnd" || viralLoadInput == "Tnd") {
setValue('viralLoadResultTest.value', 0);

}else if(viralLoadInput == "&lt;"+ "20" || viralLoadInput == "&lt;"+ " 20"){
setValue('viralLoadResultTest.value', 20);

}else if(viralLoadInput  ==  "&lt;"+ "40" || viralLoadInput  ==  "&lt;"+ " 40"){
setValue('viralLoadResultTest.value', 40);

}

});
});
</script>
    <script type="text/javascript">

var $ = jQuery;
$(document).ready(function(){
getField('viralLoadResultTest.value')[0].readOnly = true;
});
jQuery(function() {
getField('AlphanumericViralLoadResult.value').change(function() {
var viralLoadInput = getValue('AlphanumericViralLoadResult.value');
getField('viralLoadResultTest.value')[0].readOnly = true;
console.log(getField('viralLoadResultTest.value')[0])

if(viralLoadInput == 166426){
getField('viralLoadResultTest.value')[0].readOnly = false;
getField('viralLoadResultTest.value')[0].placeholder = 'Please enter interger value only';

//check if value entered i greater than 10 000 000, else return false with prompt

}else{
getField('viralLoadResultTest.value')[0].readOnly = true;
//getField('viralLoadResultTest.value')[0].required = '';
}
if (viralLoadInput == 166407) {
setValue('viralLoadResultTest.value', 19);
var conceptID = viralLoadInput
viralLoadInput = getValue('viralLoadResultTest.value');


}else if(viralLoadInput == 166408){
setValue('viralLoadResultTest.value', 28);
var conceptID = viralLoadInput
viralLoadInput = getValue('viralLoadResultTest.value');


}else if(viralLoadInput == 166409){
var conceptID = viralLoadInput
setValue('viralLoadResultTest.value', 39);
viralLoadInput = getValue('viralLoadResultTest.value');

}else if(viralLoadInput == 166410){
var conceptID = viralLoadInput
setValue('viralLoadResultTest.value', 399);
viralLoadInput = getValue('viralLoadResultTest.value');

}else if(viralLoadInput == 166411){
var conceptID = viralLoadInput
setValue('viralLoadResultTest.value', 79);
viralLoadInput = getValue('viralLoadResultTest.value');

}else if(viralLoadInput == 166420){
var conceptID = viralLoadInput
setValue('viralLoadResultTest.value', 0);
viralLoadInput = getValue('viralLoadResultTest.value');
}

else{
var conceptID = viralLoadInput
setValue('viralLoadResultTest.value', "");
viralLoadInput = getValue('viralLoadResultTest.value');

}

});
});

</script>

</htmlform>