<htmlform formUuid="889ce948-f1ee-4656-91af-147a9e760309" formName="Laboratory Order and Result form" formEncounterType="7ccf3847-7bc3-42e5-8b7e-4125712660ea" formVersion="2018">
    <style>
        .section {
        border: 1px solid $headerColor;
        padding: 2px;
        text-align: left;
        margin-bottom: 1em;
        }
        .sectionHeader {
        background-color: #2f1c55;
        color: white;
        /* display: block; */
        padding: 2px;
        font-weight: bold;
        }
        table tr:nth-child(even) {
        background: #ffffff;
        }
        .alnleft_s{
        text-align: left;
        color:#000000;
        width: 13%;
        }
        .alnright_s{
        text-align: right;
        color:#000000;
        width: 13%;
        }
        .alnright{
        text-align: right;
        color:#000000;
        width: 25%;
        }
        .alnright_i{
        text-align: right;
        color:#000000;
        width: 40%;
        }
        .alnleft{
        text-align: left;
        color:#000000;
        width: 25%;
        }
        .error{
      color:red;
        }
        td {
        border: none;
        }
        table th, table td {
        padding: 5px 10px;
        border: None;
        }
        .legend_style {
        max-width: 35%;
        background: #FAFAFA;
        <!--padding: 5px;-->
        margin: 0px left;
        box-shadow: 1px 1px 25px rgba(0,0,0,0.10);
        border-radius: 2px;
        border: 1px solid #305a72;
        border-bottom-left-radius: 2px;
        text-transform:initial;

        }
        form fieldset, .form fieldset {
        min-width: 98%;
        border: none;
        border-top: 1px solid #305a72;

        }
        table th, table td {
        padding: 5px 10px;
        /* border: 1px solid #DDD; */
        }
        table tr {
        border: None;
        }
        ul.select, .form input, .form select, .form textarea, .form ul.select {
        padding: 2px 10px;
        }
        form input, form select, form textarea, form ul.select, .form input, .form select, .form textarea, .form ul.select {
        padding: 2px 10px;
        }
        form select, .form select {
        max-width: 200px;
        }
        body {
        font-family: "OpenSans", Arial, sans-serif;
        color: #363463;
        font-size: 14px;
        }
    </style>
    <script type="text/javascript">

	var $ = jQuery;
	$(document).ready(function ()
	{
	   $('.hasDatepicker').attr('readonly', true)
	});
</script>
    <div class="hidden" id="encounter-details" sectionTag="section" headerStyle="title" headerLabel="Encounter Details">
        <fieldset>
            <legend class="legend_style">When?</legend>
            <label>When?</label>
            <encounterDate default="now" showTime="false" allowFutureDates="false"/>
        </fieldset>
        <fieldset>
            <legend>Who?</legend>
            <label>Who?</label>
            <encounterProviderAndRole default="currentUser" encounterRole="240b26f9-dd88-4172-823d-4a8bfeb7841f"                                                     required="true"/>
        </fieldset>

        <fieldset>
            <legend>Where?</legend>
            <label>Where?</label>
            <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
        </fieldset>
    </div>

    <table style="margin-bottom: 20px;">
        <thead>
        <tr><th colspan='5' style="text-align: center">Laboratory Order &amp; Result Form</th></tr>
        </thead>
    </table>

    <table class="table" width="100%">
        <tbody>
        <tr>
            <td class="alnright">Visit Date</td>
            <div style="pointer-events: none">
                <td class="alnleft"><encounterDate default="now" showTime="false" allowFutureDates="false" required="true" /></td>
            </div>
            <td class="alnright"></td>
        </tr>
        </tbody>
    </table>

    <fieldset>
        <table>
            <tr>
                <th class="alnleft"><label>Order</label></th>
                <th><label>Results</label></th>
                <th class="alnleft"><label>Order</label></th>
                <th><label>Results</label></th>
            </tr>
            <tr>

                <td class="alnleft">
                    <div class="enable_clin_control" style="pointer-events: none">
                        <obs conceptId="165731" style="checkbox" value="false" />CD4+ cell count (cells/mm3)
                    </div>
                </td>
                <td>
                    <div class="enable_lab_control" style="pointer-events: none">
                        <obs conceptId="5497"/>
                    </div>
                </td>
                <td class="alnleft">
                    <div class="enable_clin_control" style="pointer-events: none">
                        <obs conceptId="165748" style="checkbox" value="false" />CD4 (%)
                    </div>
                </td>
                <td>
                    <div class="enable_lab_control" style="pointer-events: none">
                        <obs conceptId="730"/>
                    </div>
                </td>

            </tr>
            <tr>

                <td class="alnleft">
                    <div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165732" style="checkbox" value="false" />WBC (x10<sup>9</sup> c/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="678"/></div></td>

                <td colspan="2"> </td>
            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165749" style="checkbox" value="false" />Polymorphs (/mm<sup>3</sup>) </div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1022"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165918" style="checkbox" value="false" />Polymorphs (%)</div></td>

                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165919"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165733" style="checkbox" value="false" />Lymphocytes (/mm<sup>3</sup>)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1319"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165750" style="checkbox" value="false" />Lymphocytes (%)</div></td>

                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1338"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165734" style="checkbox" value="false" />Monocytes (/mm<sup>3</sup>)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1023" /></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165751" style="checkbox" value="false" />Monocytes (%)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1339" /></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165735" style="checkbox" value="false" />Eosinophils (/mm<sup>3</sup>)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1024" /></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165752" style="checkbox" value="false" />Eosinophil (%)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1340" /></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165736" style="checkbox" value="false" />Basophils (/mm<sup>3</sup>)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1025" /></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165753" style="checkbox" value="false" />Basophils (%)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1341" /></div></td>

            </tr>

            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165737" style="checkbox" value="false" />PCV/Hb (%)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165395" /></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165921" style="checkbox" value="false" />PCV/Hb (g/dl)</div></td>

                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165920" /></div></td>

            </tr>

            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165754" style="checkbox" value="false" />Platelets (x 10<sup>9</sup> c/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="729" /></div></td>

                <td colspan="2"> </td>
            </tr>

            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165738" style="checkbox" value="false" />HCV antibody</div> </td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1325" answerConceptIds="703,664" answerLabels="Positive,Negative"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165755" style="checkbox" value="false" />HBsAG </div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="159430" answerConceptIds="703,664" answerLabels="Positive,Negative"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div id="clin19" style="pointer-events: none"><obs conceptId="165739" style="checkbox" value="false" />VDRL </div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="299" answerConceptIds="1228,1229" answerLabels="Reactive,Non-Reactive"/></div></td>


                <td class="alnleft"><div id="clin20" style="pointer-events: none"><obs conceptId="165756" style="checkbox" value="false" />Creatinine (mmol/l)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="164364"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165740" style="checkbox" value="false" />ALT/SGPT (U/I)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="654"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165922" style="checkbox" value="false" />ALT/SGPT (mmol/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165923"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165757" style="checkbox" value="false" />AST/SGOT (U/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="653"/></div></td>

                <td colspan="2"> </td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165741" style="checkbox" value="false" />Alk. Phosphate (U/l)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="785"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165758" style="checkbox" value="false" />Total Bilirubin (mmol/l)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="655"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165742" style="checkbox" value="false" />Na+ (mmol/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1132"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165759" style="checkbox" value="false" />K+ (mmol/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1133"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165743" style="checkbox" value="false" />Fasting Glucose (mmol/l)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="160053"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165760" style="checkbox" value="false" />Total Cholesterol (mmol/l)</div></td>

                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1006"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165744" style="checkbox" value="false" />LDL (mmol/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1008"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165761" style="checkbox" value="false" />HDL (mmol/L)</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1007"/></div></td>

            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165745" style="checkbox" value="false" />Glucose</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="160053"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165762" style="checkbox" value="false" />Protein</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165926"/></div></td>


            </tr>
            <tr>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165746" style="checkbox" value="false" />Cytology/Pap Smear: </div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165927"/></div></td>


                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165763" style="checkbox" value="false" />Triglyceride</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="1009"/></div></td>

            </tr>

            <tr>
                <excludeIf velocityTest="$patient.gender == 'M' ">

                    <td  class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165747" style="checkbox" value="false" />Pregnancy</div></td>


                    <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="45" answerConceptIds="703,664" answerLabels="Positive,Negative"/></div></td>
                </excludeIf>

                <td class="alnleft"><div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165764" style="checkbox" value="false" />Malaria smear</div></td>


                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="32" answerConceptIds="664,703"
                                                                                      answerLabels="Positive,Negative" /></div></td>

            </tr>
        </table>
    </fieldset>

    <fieldset>
        <legend class="legend_style">Viral Load</legend>
        <table>
            <tr>

                <td class="alnright">
                    <div class="enable_clin_control" style="pointer-events: none"><obs conceptId="165765" style="checkbox" value="false" labelText="Viral Load Test" toggle="viralLoad"/> </div>
                </td>
            </tr>
        </table>
        <table id="viralLoad">
        	<tr>	
        	<includeIf velocityTest="$user.hasRole('Lab') || $user.hasRole('Clinician')">
	       		
	                <td><font color='red'>Last Sample collection date:</font></td>
					<td><font color='blue' style="font-weight: bold"><lookup expression="fn.latestObs('159951').obsDatetime" /></font></td>
	                
					<td><font color='red'>Last Sample Type:</font></td>
					<td><font color='blue' style="font-weight: bold"><lookup complexExpression="$fn.latestObs('162476').valueCoded.name"/></font></td>
					
					<td><font color='red'>Last Indication for Viral Load:</font></td>
					<td><font color='blue' style="font-weight: bold"><lookup complexExpression="$fn.latestObs('164980').valueCoded.name"/></font></td>
	         </includeIf>
	        </tr>           
            <tr>
                <includeIf velocityTest="$user.hasRole('Lab')">
                    <td class="alnleft_s">PCR Lab Sample No.</td>
                    <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165715"/></div></td>
               
                </includeIf>
                
                <includeIf velocityTest="$user.hasRole('Lab') || $user.hasRole('Clinician')">
                    <td class="alnleft_s">Sample ID.</td>
                	<td><div><obs conceptId="165715"/></div></td>
                    <td class="alnleft_s">Sample Type</td>
                    <td><div><obs conceptId="162476" answerConceptIds="1000,165568" answerLabels="Whole Blood/Plasma,DBS"/></div></td>                            
                    <td class="alnleft_s">Indication for Viral Load</td>
                    <td><div><obs id="viral_load" conceptId="164980" answerConceptIds="162080,161236,162082,162081,163523,160566, 165978" answerLabels="Baseline (6 months after ART initiation), Routine (every 12 months), Confirmation (3-6 months after intense adherence counselling), Repeat test, Clinical failure, Immunological failure, PMTCT 32-36 weeks gestation">
                        <controls>
                            <when value="162081" thenDisplay="#repeat_id"/>
                        </controls>
                    </obs>
                    </div>
                    </td>
                </includeIf>
            </tr>

            <includeIf velocityTest="$user.hasRole('Lab')">
                <tr>
                    <td colspan="2" id="repeat_id">
                        <table>
                            <tr>
                                <td class="alnleft_s">Reason for Repeat</td>
                                <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165831"/></div></td>
                            </tr>
                        </table>
                    </td>
                    <td class="alnleft_s">Sample collection date</td>
                    <td><div class="enable_lab_control"  style="pointer-events: none"><obs required="true" conceptId="159951"/></div></td>
                    <td class="alnleft_s">Date sample sent to PCR Lab</td>
                    <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165988" /></div></td>
                    <td class="alnleft_s">Date sample received at PCR Lab</td>
                    <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165716"/></div></td>
                </tr>
                <tr>
                    <td class="alnleft_s">Viral Load test result</td>
                    <td><div class="enable_lab_control" style="pointer-events: none"><obs required="true" conceptId="856" labelText=""/>copies/ml</div></td>

                    <td class="alnleft_s">Date result was sent from PCR Lab</td>
                    <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165989" /></div></td>

                    <td class="alnleft_s">Date result was received at the facility</td>
                    <td><div class="enable_lab_control" style="pointer-events: none"><obs conceptId="165987" /></div></td>

                </tr>
            </includeIf>
        </table>
    </fieldset>
    <fieldset>
        <legend class="legend_style">Signatures</legend>
        <table>
            <tr>
                <td class="alnleft_s">Name of Clinician</td>
                <td><encounterProvider role="Clinician" default="currentUser" required="false" /></td>
                <td class="alnleft_s">Date Ordered</td>
                <td><obs conceptId="164989" required="true" allowFutureDates="false"/></td>

                <td class="alnleft_s"></td>
                <td class="alnleft_s"></td>
            </tr>
            <includeIf velocityTest="$user.hasRole('Lab')">
                <tr>
                    <td class="alnleft_s">Reported By</td>
                    <td><obs conceptId="164982" style="person" /></td>
                    <td class="alnleft_s">Date Reported</td>
                    <td><obs required="true" conceptId="165414" allowFutureDates="false"/></td>


                    <td class="alnleft_s"></td>
                    <td class="alnleft_s"></td>
                </tr>
            </includeIf>
            <tr>
                <td class="alnleft_s">Checked By</td>
                <td><obs conceptId="164983" labelText="" style="person" /></td>
                <td class="alnleft_s">Date checked</td>
                <td><obs conceptId="164984" allowFutureDates="false"/></td>

                <td class="alnleft_s"></td>
                <td class="alnleft_s"></td>
            </tr>
            <tr>
                <td class="alnleft_s">Facility</td>
                <td><encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/></td>
            </tr>
        </table>
    </fieldset>
    <submit/>

    <includeIf velocityTest="$user.hasRole('Clinician') || $user.hasRole('Nurse')">
        <script>
            var items = document.getElementsByClassName("enable_clin_control");
            for(var i=0; i &lt; items.length; i++){
               items[i].style.pointerEvents = "unset";
            }
        </script>
    </includeIf>
    <includeIf velocityTest="$user.hasRole('Lab')">
        <script>
            var itemss = document.getElementsByClassName("enable_lab_control");
            for(var j=0; j &lt; itemss.length; j++){
               itemss[j].style.pointerEvents = "unset";
            }
        </script>
    </includeIf>

</htmlform>